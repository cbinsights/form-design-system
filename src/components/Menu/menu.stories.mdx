import { Meta, Preview, Story, Props, Source } from "@storybook/addon-docs/blocks";
import {
  withKnobs,
  array,
  text,
  boolean,
  optionsKnob as options
} from "@storybook/addon-knobs";
import { action } from '@storybook/addon-actions';

import Button from 'components/Button';

import Flex from 'components/Flex';
import FlexItem from 'components/FlexItem';

import CloneIcon from 'lib/icons/react/CloneIcon';
import TrashIcon from 'lib/icons/react/TrashIcon';
import EditIcon from 'lib/icons/react/EditIcon';
import FundingIcon from 'lib/icons/react/FundingIcon';
import Tooltip from 'components/Tooltip';

import { ImportPath } from 'components/util/storybook';

import Menu from '.';
import { MenuItem } from 'components';


<Meta title="Components/Menu" component={Menu} decorators={[withKnobs]} />

# Menu

<ImportPath component={Menu} section="popovers" />
<ImportPath component={MenuItem} section="popovers" />

Renders a basic keyboard navigable dropdown menu following the [WAI-ARIA pattern for "menubutton"](https://www.w3.org/TR/wai-aria-practices-1.1/#menubutton).

### When to use Menu
Only use a `Menu` for dropdowns that contain actions the user can take. If a dropdown includes any other type of content (forms, arbitrary content), use a `Popover` component instead.

### Positioning
The menu will automatically position above or below the trigger button based on its position in the viewport.

<Story name="Knobs" parameters={{ docs: { disable: true }}}>
  <div style={{ padding: '2rem' }}>
    <Menu
      trigger={<Button label={text('label', 'Menu trigger')} hasCaret />}>
      {array('Menu Items', ['First', 'Second', 'Third', 'Fourth']).map((item) => (
        <MenuItem onSelect={action(`clicked ${item}`)}>{item}</MenuItem>
      ))}
    </Menu>
  </div>
</Story>

<Preview isExpanded>
  <Menu trigger={<Button label="Menu trigger" hasCaret />}>
    <MenuItem onSelect={action('copy')}>
      Copy
    </MenuItem>
    <MenuItem onSelect={action('delete')}>
      Delete
    </MenuItem>
  </Menu>
</Preview>

## Menu Props

<Props of={Menu} />

## MenuItem Props

<Props of={MenuItem} />

## Trigger element

A `Button` with the `hasCaret` prop enabled is recommended, but the Menu trigger can accept a `button`, or any component that renders a focusable element.

<Preview>
  <Story name="Trigger element">
    <Flex>
      <FlexItem>
        <Menu
          trigger={<Button theme="outlined" label="Recommended trigger" hasCaret />}>
            <MenuItem onSelect={action('🍰')}>Cake</MenuItem>
            <MenuItem onSelect={action('🍕')}>Pizza</MenuItem>
            <MenuItem onSelect={action('☠️')}>Tide pod</MenuItem>
        </Menu>
      </FlexItem>
      <FlexItem>
        <Menu
          trigger={<button>any button will work</button>}>
            <MenuItem onSelect={action('🍰')}>Cake</MenuItem>
            <MenuItem onSelect={action('🍕')}>Pizza</MenuItem>
            <MenuItem onSelect={action('☠️')}>Tide pod</MenuItem>
        </Menu>
      </FlexItem>
    </Flex>
  </Story>
</Preview>

## Custom menu items

`MenuItem` components will accept a plain string or any JSX node.

<Preview>
  <Story name="Custom items">
    <Menu
      trigger={<Button hasCaret label="actions" theme="outlined" />}>
        <MenuItem onSelect={action('Delete')}>
          <div className="color--primary">
            <Flex align="center">
              <FlexItem shrink><TrashIcon /></FlexItem>
              <FlexItem>Delete</FlexItem>
            </Flex>
          </div>
        </MenuItem>
        <MenuItem onSelect={action('Edit')}>
          <div className="color--primary">
            <Flex align="center">
              <FlexItem shrink><EditIcon /></FlexItem>
              <FlexItem>Edit</FlexItem>
            </Flex>
          </div>
        </MenuItem>
        <MenuItem onSelect={action('Clone')}>
          <div className="color--primary">
            <Flex align="center">
              <FlexItem shrink><CloneIcon /></FlexItem>
              <FlexItem>Clone</FlexItem>
            </Flex>
          </div>
        </MenuItem>
        <MenuItem onSelect={action('Bribe')}>
          <div className="color--primary">
            <Flex align="center">
              <FlexItem shrink><FundingIcon /></FlexItem>
              <FlexItem>Bribe</FlexItem>
            </Flex>
          </div>
        </MenuItem>
    </Menu>
  </Story>
</Preview>

## Disabled menu items

When the `isDisabled` prop is passed to a `MenuItem`, the item will be styled as disabled
and the `onSelect` handler will not be called.

Prefer hiding actions instead of disabling them. Only disable a `MenuItem` if the
disabling is only temporary (e.g. disabling a collections clone while a clone is in
progress).

When disabling a `MenuItem`, a `Tooltip` is recommended to explain why the action is disabled.

<Preview>
  <Story name="Disabled items">
    <Menu
      trigger={<Button theme="outlined" label="Menu with disabled item" hasCaret />}>
        <MenuItem isDisabled onSelect={() => { alert('🍰') }}>
          <Tooltip
            trigger="Cake"
            message="Not your birthday"
          />
        </MenuItem>
        <MenuItem onSelect={() => { alert('🍕') }}>Pizza</MenuItem>
        <MenuItem onSelect={() => { alert('☠️') }}>Tide pod</MenuItem>
    </Menu>
  </Story>
</Preview>

